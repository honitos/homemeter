#!/usr/bin/env python

from __future__ import print_function
import time
from RF24 import *
from RF24Network import *
from RF24Mesh import *
import RPi.GPIO as GPIO


def rf24_init():
    global radio, network, mesh
    #RPi B
    # Setup for GPIO 22 CE and CE1 CSN with SPI Speed @ 8Mhz
    radio = RF24(RPI_V2_GPIO_P1_22, BCM2835_SPI_CS0, BCM2835_SPI_SPEED_8MHZ)
    network = RF24Network(radio)
    mesh = RF24Mesh(radio,network)

    # set the Node ID as Master, which will be 0
    mesh.setNodeID(0);
    mesh.begin()
    radio.printDetails()

    while 1:
	mesh.update()
	mesh.DHCP()
	while network.available():
	    print("empfange etwas!")


if __name__ == "__main__":
    rf24_init()
    exit()
